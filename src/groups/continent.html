[% 
  WRAPPER layout title = "Perl Mongers: $continent"
   onload="initialize"
   onunload="GUnload"
%]

<script type="text/javascript">
var longitude = [% longitude %];
var latitude = [% latitude %];
var zoom = [% zoom %];
var coords = [

[% FOREACH country = groups.keys.sort %]
  [% IF country == 'United States of America' %]
    [% FOREACH state = groups.$country.keys.sort %]
      [% FOREACH group = groups.$country.$state %]
        [% IF group.latitude %]
          [ [% group.latitude %], [% group.longitude %] ],
        [% END %]
      [% END %]
    [% END %]
  [% ELSE %]
      [% FOREACH group = groups.$country %]
        [% IF group.latitude %]
          [ [% group.latitude %], [% group.longitude %] ],
        [% END %]
      [% END %]
  [% END %]
[% END %]
];
</script> 

<div id="map-canvas" style="width: 500px; height: 400px"></div>

[% IF groups.keys.size %]

<p>The following groups are in [% continent %]:</p>

[% FOREACH country = groups.keys.sort %]
<h2><a href="[% country_links.$country %]">[% country %]</a></h2>

  [% IF country == 'United States of America' %]
    [% FOREACH state = groups.$country.keys.sort %]
    <h3>[% state %]</h3>
    <ul>
      [% FOREACH group = groups.$country.$state %]
        <li><a href="[% group.id %].html">[% group.name | html_entity %]</a></li>
      [% END %]
    </ul>
    [% END %]
  [% ELSE %]
    <ul>
      [% FOREACH group = groups.$country %]
        <li><a href="[% group.id %].html">[% group.name | html_entity %]</a></li>
      <!--  <li><a href="[% group.web %]">[% group.name | html_entity %]</a> (<a href="[% group.id %].html">?</a>)</li> -->
      [% END %]
    </ul>
  [% END %]

[% END %]

[% ELSE %]
<p>There are currently no groups in [% continent %].</p>
[% END %]

[% END %]
